<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Flocking 2D · EasyABM.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="EasyABM.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">EasyABM.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../tutorial/">A simple example</a></li><li><a class="tocitem" href="../cheatsheet/">Working with different types of models</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../schelling/">Schellings Segregation 2D</a></li><li class="is-active"><a class="tocitem" href>Flocking 2D</a><ul class="internal"><li><a class="tocitem" href="#Step-1:-Create-Agents-and-Model"><span>Step 1: Create Agents and Model</span></a></li><li><a class="tocitem" href="#Step-2:-Initialise-the-model"><span>Step 2: Initialise the model</span></a></li><li><a class="tocitem" href="#Step-3:-Defining-the-step_rule!-and-running-the-model"><span>Step 3: Defining the step_rule! and running the model</span></a></li><li><a class="tocitem" href="#Step-4:-Visualisation"><span>Step 4: Visualisation</span></a></li><li><a class="tocitem" href="#Step-5:-Fetch-Data"><span>Step 5: Fetch Data</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../stone_paper_scissor/">Rock-Paper-Scissor</a></li><li><a class="tocitem" href="../SIR/">SIR model</a></li><li><a class="tocitem" href="../predator_prey/">Predator-prey</a></li><li><a class="tocitem" href="../conwaygol/">Conways Game of Life</a></li><li><a class="tocitem" href="../random_walkers/">Random Walkers</a></li><li><a class="tocitem" href="../schelling3d/">Schellings Segregation 3D</a></li><li><a class="tocitem" href="../percolation_grid_graph2d/">Percolation on a 2d grid graph</a></li><li><a class="tocitem" href="../boids3d/">Flocking 3D</a></li><li><a class="tocitem" href="../ising/">Ising on a grid graph</a></li><li><a class="tocitem" href="../simple_pendulum/">Simple Pendulum</a></li><li><a class="tocitem" href="../BrownianParticle/">Brownian Particle</a></li><li><a class="tocitem" href="../nearest_neighbor_graph/">Nearest Neighbor Graph</a></li><li><a class="tocitem" href="../nearest_neighbor_graph_3dvis/">Nearest Neighbor Graph 3D</a></li><li><a class="tocitem" href="../ElemCA/">Elementary Cellular Automaton</a></li><li><a class="tocitem" href="../abelian_sandpile/">Abelian Sandpile</a></li><li><a class="tocitem" href="../NNSIsing/">Ising on a nearest neighbor graph</a></li><li><a class="tocitem" href="../NNS3DIsing/">Ising on a nearest neighbor graph 3D</a></li></ul></li><li><a class="tocitem" href="../tips/">Do&#39;s and Don&#39;ts</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Flocking 2D</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Flocking 2D</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/RenuSolanki/EasyABM.jl/blob/main/docs/src/boids.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Flocking"><a class="docs-heading-anchor" href="#Flocking">Flocking</a><a id="Flocking-1"></a><a class="docs-heading-anchor-permalink" href="#Flocking" title="Permalink"></a></h1><pre><code class="language-julia hljs">using EasyABM</code></pre><h2 id="Step-1:-Create-Agents-and-Model"><a class="docs-heading-anchor" href="#Step-1:-Create-Agents-and-Model">Step 1: Create Agents and Model</a><a id="Step-1:-Create-Agents-and-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-Create-Agents-and-Model" title="Permalink"></a></h2><p>Lets create 200 agents with properties <code>shape</code>, <code>pos</code>, <code>vel</code> and <code>orientation</code> (The <code>orientation</code> property is used internally by EasyABM to draw the direction agent is facing). The position <code>pos</code> is only accepted as a Vect which is an inbuilt vector type in EasyABM. It is also recommended for both convenience as well as performance to use Vect type for any vectorial properties in the model such as velocity and forces. The <code>keeps_record_of</code> argument is set of properties that the agent will record during time evolution. The model is defined with properties:</p><ul><li><code>min_dis</code> : The distance between boids below which they start repelling each other.</li><li><code>coh_fac</code> : The proportionality constant for the cohere force. </li><li><code>sep_fac</code> : The proportionality constant for the separation force.</li><li><code>aln_fac</code> : The proportionality constant for the alignment force.</li><li><code>vis_range</code> : The visual range of boids.</li><li><code>dt</code> : The proportionality constant between change in position and velocity.</li></ul><p>The argument <code>agents_type</code> is set to Static which means that the agents number will remain fixed during simulation. </p><pre><code class="language-julia hljs">boids = con_2d_agents(200, shape = :arrow, pos = Vect(0.0,0.0), 
    vel=Vect(0.0,0.0), orientation = 0.0, keeps_record_of = Set([:pos, :vel, :orientation]))
model = create_2d_model(boids,
    agents_type=Static, space_type = Periodic, 
    min_dis = 0.3, coh_fac = 0.05, 
    sep_fac = 0.5, dt= 0.1, vis_range = 2.0, aln_fac = 0.35)</code></pre><h2 id="Step-2:-Initialise-the-model"><a class="docs-heading-anchor" href="#Step-2:-Initialise-the-model">Step 2: Initialise the model</a><a id="Step-2:-Initialise-the-model-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-Initialise-the-model" title="Permalink"></a></h2><p>In this step we set the positions, velocities and orientations of boids and initialise the model.</p><pre><code class="language-julia hljs">function initialiser!(model)
    xdim, ydim = model.size
    for boid in model.agents
        boid.pos = Vect(rand()*xdim, rand()*ydim)
        boid.orientation = rand()*2*3.14
        boid.vel = Vect(-sin(boid.orientation), cos(boid.orientation))
    end
end

init_model!(model, initialiser = initialiser!)</code></pre><h2 id="Step-3:-Defining-the-step_rule!-and-running-the-model"><a class="docs-heading-anchor" href="#Step-3:-Defining-the-step_rule!-and-running-the-model">Step 3: Defining the step_rule! and running the model</a><a id="Step-3:-Defining-the-step_rule!-and-running-the-model-1"></a><a class="docs-heading-anchor-permalink" href="#Step-3:-Defining-the-step_rule!-and-running-the-model" title="Permalink"></a></h2><p>In this step we implement the step logic of the flocking model in the <code>step_rule!</code> function and run the model for 500 steps. </p><pre><code class="language-julia hljs">
const ep = 0.00001

function step_rule!(model)
    dt = model.properties.dt
    for boid in model.agents
        nbrs = neighbors(boid, model, model.properties.vis_range)
        coh_force = Vect(0.0,0.0) # For a Vect all coordinates must be of same type
        sep_force = Vect(0.0,0.0) 
        aln_force = Vect(0.0,0.0)
        num = 0
        for nbr in nbrs
            num+=1
            vec = nbr.pos - boid.pos
            coh_force += vec
            if veclength(vec)&lt; model.properties.min_dis
                sep_force -= vec
            end
            aln_force += nbr.vel
        end
        aln_force = num&gt;0 ? (aln_force / num - boid.vel) * model.properties.aln_fac : aln_force
        num = max(1, num)
        coh_force *= (model.properties.coh_fac / num)
        sep_force *=  model.properties.sep_fac
        boid.vel  += (coh_force + sep_force) + aln_force
        boid.vel  /= (veclength(boid.vel)+ep)
        boid.orientation = calculate_direction(boid.vel)
        boid.pos += boid.vel*dt
    end
end

run_model!(model, steps=500, step_rule = step_rule!)</code></pre><h2 id="Step-4:-Visualisation"><a class="docs-heading-anchor" href="#Step-4:-Visualisation">Step 4: Visualisation</a><a id="Step-4:-Visualisation-1"></a><a class="docs-heading-anchor-permalink" href="#Step-4:-Visualisation" title="Permalink"></a></h2><p>In order to draw the model at a specific frame, say 4th, one can use <code>draw_frame(model, frame = 4 )</code>. If one wants to see the animation of the model run, it can be done as </p><pre><code class="language-julia hljs">animate_sim(model)</code></pre><p><img src="../assets/Boids/BoidsAnim1.png" alt="png"/></p><p>After defining the <code>step_rule!</code> function we can also choose to create an interactive application (which currently works in Jupyter with WebIO installation) as follows. It is recommended to define a fresh model and not initialise it with <code>init_model!</code> or run with <code>run_model!</code> before creating interactive app. </p><pre><code class="language-julia hljs">boids = con_2d_agents(200, shape = :arrow, pos = Vect(0.0,0.0), 
    vel=Vect(0.0,0.0), orientation = 0.0, keeps_record_of = Set([:pos, :vel, :orientation]))
    
model = create_2d_model(boids,
    agents_type=Static, space_type = Periodic, 
    min_dis = 0.3, coh_fac = 0.05, 
    sep_fac = 0.5, dt= 0.1, vis_range = 2.0, aln_fac = 0.35)

create_interactive_app(model, initialiser= initialiser!,
    step_rule= step_rule!,
    model_controls=[(:min_dis, &quot;slider&quot;, 0.01:0.1:1.0),
        (:coh_fac, &quot;slider&quot;, 0.01:0.01:1.0),
        (:sep_fac, &quot;slider&quot;, 0.01:0.01:1.0),
        (:aln_fac, &quot;slider&quot;, 0.01:0.01:1.0),
        (:vis_range, &quot;slider&quot;, 0.5:0.5:4.0)], frames=400) </code></pre><p><img src="../assets/Boids/BoidsIntApp.png" alt="png"/></p><h2 id="Step-5:-Fetch-Data"><a class="docs-heading-anchor" href="#Step-5:-Fetch-Data">Step 5: Fetch Data</a><a id="Step-5:-Fetch-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Step-5:-Fetch-Data" title="Permalink"></a></h2><p>It is easy to fetch any data recorded during simulation. For example, the data of average velocity of agents at each time step can be obtained as - </p><pre><code class="language-julia hljs">df = get_agents_avg_props(model, agent -&gt; agent.vel, labels = [&quot;average velocity&quot;])</code></pre><p>Individual agent data recorded during model run can be obtained as </p><pre><code class="language-julia hljs">df = get_agent_data(model.agents[1], model).record</code></pre><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ol><li>https://en.wikipedia.org/wiki/Flocking</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../schelling/">« Schellings Segregation 2D</a><a class="docs-footer-nextpage" href="../stone_paper_scissor/">Rock-Paper-Scissor »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Monday 6 November 2023 12:00">Monday 6 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
