<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Abelian Sandpile · EasyABM.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="EasyABM.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">EasyABM.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../schelling/">Schellings Segregation 2D</a></li><li><a class="tocitem" href="../boids/">Flocking 2D</a></li><li><a class="tocitem" href="../stone_paper_scissor/">Rock-Paper-Scissor</a></li><li><a class="tocitem" href="../SIR/">SIR model</a></li><li><a class="tocitem" href="../predator_prey/">Predator-prey</a></li><li><a class="tocitem" href="../conwaygol/">Conways Game of Life</a></li><li><a class="tocitem" href="../random_walkers/">Random Walkers</a></li><li><a class="tocitem" href="../schelling3d/">Schellings Segregation 3D</a></li><li><a class="tocitem" href="../boids3d/">Flocking 3D</a></li><li><a class="tocitem" href="../ising/">Ising on a grid graph</a></li><li><a class="tocitem" href="../simple_pendulum/">Simple Pendulum</a></li><li><a class="tocitem" href="../BrownianParticle/">Brownian Particle</a></li><li><a class="tocitem" href="../nearest_neighbor_graph/">Nearest Neighbor Graph</a></li><li><a class="tocitem" href="../ElemCA/">Elementary Cellular Automaton</a></li><li class="is-active"><a class="tocitem" href>Abelian Sandpile</a><ul class="internal"><li><a class="tocitem" href="#Step-1:-Create-Model"><span>Step 1: Create Model</span></a></li><li><a class="tocitem" href="#Step-2:-Initialise-the-model"><span>Step 2: Initialise the model</span></a></li><li><a class="tocitem" href="#Step-3:-Defining-the-step_rule!-and-running-the-model"><span>Step 3: Defining the step_rule! and running the model</span></a></li><li><a class="tocitem" href="#Step-4:-Visualisation"><span>Step 4: Visualisation</span></a></li><li><a class="tocitem" href="#Step-5:-Fetch-Data"><span>Step 5: Fetch Data</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../NNSIsing/">Ising on a nearest neighbor graph</a></li></ul></li><li><a class="tocitem" href="../tips/">Do&#39;s and Don&#39;ts</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Abelian Sandpile</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Abelian Sandpile</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/RenuSolanki/EasyABM.jl/blob/main/docs/src/abelian_sandpile.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Abelian-Sandpile"><a class="docs-heading-anchor" href="#Abelian-Sandpile">Abelian Sandpile</a><a id="Abelian-Sandpile-1"></a><a class="docs-heading-anchor-permalink" href="#Abelian-Sandpile" title="Permalink"></a></h1><pre><code class="language-julia hljs">using EasyABM</code></pre><h2 id="Step-1:-Create-Model"><a class="docs-heading-anchor" href="#Step-1:-Create-Model">Step 1: Create Model</a><a id="Step-1:-Create-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-Create-Model" title="Permalink"></a></h2><p>In this model, we work with patches only. We set <code>grid_size</code> to (50,50), set <code>space_type</code> to NPeriodic and define an additional model parameter <code>threshold</code> whose value is set to 4. </p><pre><code class="language-julia hljs">model = create_2d_model(size = (50,50), space_type=NPeriodic, threshold = 4)</code></pre><h2 id="Step-2:-Initialise-the-model"><a class="docs-heading-anchor" href="#Step-2:-Initialise-the-model">Step 2: Initialise the model</a><a id="Step-2:-Initialise-the-model-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-Initialise-the-model" title="Permalink"></a></h2><p>Initially, we set the amount of sand on all patches equal to 2 except for the patch (25,25) where we set the sand amount to value 2000. The color attribute of patches is set according to the amount of sand they carry. If the sand amound on a patch is &gt;=4 then its color is blue, otherwise the color is set according to dictionary coldict. </p><pre><code class="language-julia hljs">const coldict = Dict(0=&gt;cl&quot;white&quot;, 1=&gt;cl&quot;yellow&quot;, 2=&gt;cl&quot;green&quot;, 3=&gt; cl&quot;orange&quot;, 4=&gt;cl&quot;red&quot;)

function initialiser!(model)
    for j in 1:model.size[2]
        for i in 1:model.size[1]
            model.patches[i,j].sand = 2
            model.patches[i,j].color= coldict[2]
        end
    end
    model.patches[25,25].sand = 2000
    model.patches[25,25].color= cl&quot;blue&quot;
end

init_model!(model, initialiser = initialiser!, props_to_record = Dict(&quot;patches&quot; =&gt; Set([:color,:sand])))</code></pre><h2 id="Step-3:-Defining-the-step_rule!-and-running-the-model"><a class="docs-heading-anchor" href="#Step-3:-Defining-the-step_rule!-and-running-the-model">Step 3: Defining the step_rule! and running the model</a><a id="Step-3:-Defining-the-step_rule!-and-running-the-model-1"></a><a class="docs-heading-anchor-permalink" href="#Step-3:-Defining-the-step_rule!-and-running-the-model" title="Permalink"></a></h2><p>In the step function we loop over all the patches and if a patch has sand &gt;= 4, we topple that patch which means that i) We reduce the amount of sand on that patch by 4 ii) We increase the amount of sand on its Von Neumann neighboring patches by 1. </p><pre><code class="language-julia hljs">
function topple!(patch_loc, model, threshold)
    nbr_patch_locs = neighbor_patches_neumann(patch_loc, model, 1)
    for p in nbr_patch_locs
        pth_patch = model.patches[p...]
        sand = pth_patch.sand + 1
        pth_patch.sand = sand
        pth_patch.color = sand &lt;= 4 ? coldict[sand] : cl&quot;blue&quot; 
    end
    patch = model.patches[patch_loc...]
    sand = patch.sand-threshold
    patch.sand = sand
    patch.color = sand &lt;= 4 ? coldict[sand] : cl&quot;blue&quot; 
end

function step_rule!(model)
    threshold = model.parameters.threshold
    for j in 1:model.size[2]
        for i in 1:model.size[1]
            if model.patches[i,j].sand&gt;=threshold
                topple!((i,j),model, threshold)
            end
        end
    end
end

run_model!(model, steps = 1000, step_rule = step_rule!)</code></pre><h2 id="Step-4:-Visualisation"><a class="docs-heading-anchor" href="#Step-4:-Visualisation">Step 4: Visualisation</a><a id="Step-4:-Visualisation-1"></a><a class="docs-heading-anchor-permalink" href="#Step-4:-Visualisation" title="Permalink"></a></h2><p>In order to draw the model at a specific frame, say 4th, one can use <code>draw_frame(model, frame = 4 )</code>. If one wants to see the animation of the model run, it can be done as </p><pre><code class="language-julia hljs">animate_sim(model)</code></pre><p><img src="../assets/AbelianSandpile/AbelianSandpileAnim1.png" alt="png"/></p><p>After defining the <code>step_rule!</code> function we can also choose to create an interactive application (which currently works in Jupyter with WebIO installation) as </p><pre><code class="language-julia hljs">create_interactive_app(model, initialiser= initialiser!,
    props_to_record = Dict(&quot;patches&quot; =&gt; Set([:color])),
    model_controls = [(:threshold, &quot;slider&quot;, 1:10)],
    step_rule= step_rule!,frames=500, show_patches=true) </code></pre><p><img src="../assets/AbelianSandpile/AbelianSandpileIntApp1.png" alt="png"/></p><h2 id="Step-5:-Fetch-Data"><a class="docs-heading-anchor" href="#Step-5:-Fetch-Data">Step 5: Fetch Data</a><a id="Step-5:-Fetch-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Step-5:-Fetch-Data" title="Permalink"></a></h2><p>It is easy to fetch any recorded data after running the model. For example, the numbers of patches with different amounts of sand at all timesteps can be got as follows</p><pre><code class="language-julia hljs">df = get_nums_patches(model, 
    patch-&gt; patch.sand == 0, 
    patch-&gt; patch.sand == 1, 
    patch-&gt; patch.sand == 2, 
    patch-&gt; patch.sand == 3,
    labels=[&quot;sand=0&quot;,&quot;sand=1&quot;,&quot;sand=2&quot;,&quot;sand=3&quot;], plot_result=true)</code></pre><p><img src="../assets/AbelianSandpile/plot1.png" alt="png"/></p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>1.) https://en.wikipedia.org/wiki/Abelian<em>sandpile</em>model</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ElemCA/">« Elementary Cellular Automaton</a><a class="docs-footer-nextpage" href="../NNSIsing/">Ising on a nearest neighbor graph »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Friday 20 October 2023 20:05">Friday 20 October 2023</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
