<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>A simple example · EasyABM.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="EasyABM.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">EasyABM.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">Getting started</span><ul><li class="is-active"><a class="tocitem" href>A simple example</a><ul class="internal"><li><a class="tocitem" href="#Step-1:-Create-the-agents-and-the-model."><span>Step 1: Create the agents and the model.</span></a></li><li><a class="tocitem" href="#Step-2:-Initialise-the-model."><span>Step 2: Initialise the model.</span></a></li><li><a class="tocitem" href="#Step-3:-Define-a-step_rule-and-run-the-model"><span>Step 3: Define a <code>step_rule</code> and run the model</span></a></li><li><a class="tocitem" href="#Step-4:-Visualisation"><span>Step 4: Visualisation</span></a></li><li><a class="tocitem" href="#Step-5:-Fetch-data"><span>Step 5: Fetch data</span></a></li></ul></li><li><a class="tocitem" href="../cheatsheet/">Working with different types of models</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../schelling/">Schellings Segregation 2D</a></li><li><a class="tocitem" href="../boids/">Flocking 2D</a></li><li><a class="tocitem" href="../stone_paper_scissor/">Rock-Paper-Scissor</a></li><li><a class="tocitem" href="../SIR/">SIR model</a></li><li><a class="tocitem" href="../predator_prey/">Predator-prey</a></li><li><a class="tocitem" href="../conwaygol/">Conways Game of Life</a></li><li><a class="tocitem" href="../random_walkers/">Random Walkers</a></li><li><a class="tocitem" href="../schelling3d/">Schellings Segregation 3D</a></li><li><a class="tocitem" href="../percolation_grid_graph2d/">Percolation on a 2d grid graph</a></li><li><a class="tocitem" href="../boids3d/">Flocking 3D</a></li><li><a class="tocitem" href="../ising/">Ising on a grid graph</a></li><li><a class="tocitem" href="../simple_pendulum/">Simple Pendulum</a></li><li><a class="tocitem" href="../BrownianParticle/">Brownian Particle</a></li><li><a class="tocitem" href="../nearest_neighbor_graph/">Nearest Neighbor Graph</a></li><li><a class="tocitem" href="../nearest_neighbor_graph_3dvis/">Nearest Neighbor Graph 3D</a></li><li><a class="tocitem" href="../ElemCA/">Elementary Cellular Automaton</a></li><li><a class="tocitem" href="../abelian_sandpile/">Abelian Sandpile</a></li><li><a class="tocitem" href="../NNSIsing/">Ising on a nearest neighbor graph</a></li><li><a class="tocitem" href="../NNS3DIsing/">Ising on a nearest neighbor graph 3D</a></li></ul></li><li><a class="tocitem" href="../tips/">Do&#39;s and Don&#39;ts</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Getting started</a></li><li class="is-active"><a href>A simple example</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>A simple example</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/RenuSolanki/EasyABM.jl/blob/main/docs/src/tutorial.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p>Studying an agents based model in EasyABM is basically a 5-step process. </p><ol><li>Create agents and model. </li><li>Initialise the model, using the <code>init_model!</code> function.</li><li>Define a <code>step_rule</code> function and run the model. </li><li>Visualisation which can be achieved simply by running <code>animate_sim(model)</code>. One can alo explore the model through an interactive app that can be created using the function <code>create_interactive_app</code>. </li><li>Fetch and analyse data collected during model run. </li></ol><p>We explain these steps below through a very simple model of a star-planet system. Though it can be debated if a star-planet system can really qualify as an agent based model, it nevertheless serves as a good example for demonstrating the workings of EasyABM. </p><h2 id="Step-1:-Create-the-agents-and-the-model."><a class="docs-heading-anchor" href="#Step-1:-Create-the-agents-and-the-model.">Step 1: Create the agents and the model.</a><a id="Step-1:-Create-the-agents-and-the-model.-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-Create-the-agents-and-the-model." title="Permalink"></a></h2><p>In the first step we create the agents and the model. For the star-planet system, we need one agent for the star and one for the planet. We will assume that the star is stationary and the planet revolves around it. We set the position of the star to be Vect(5.0,5.0) which is the center point of the 2d space, as the default dimensions of 2d space in EasyABM is 10x10. The position <code>pos</code> is only accepted as a Vect which is an inbuilt vector type in EasyABM. It is also recommended for both convenience as well as performance to use Vect type for any vectorial properties in the model such as velocity and forces. We set the position of the planet to be Vect(7.0,5.0) and its velocity to be Vect(0.0,1.0). Since, the planet will change its position we require it to record its position and velocity during the model run. We specify this via <code>keeps_record_of</code> argument in the function for creating agent(s). We also have user defined model properties <code>gravity</code> and <code>dt</code> which stand for the force of gravity and small time interval between position and velocity updates respectively. </p><pre><code class="language-julia hljs">star = con_2d_agent( pos = Vect(5.0,5.0), size = 0.30, color = cl&quot;yellow&quot;) # by default 2d space is 10x10, so that (5,5) is center.
planet = con_2d_agent(pos = Vect(7.0,5.0), vel = Vect(0.0,1.0), size=0.15, color = cl&quot;blue&quot;, keeps_record_of = Set([:pos, :vel])) 
model = create_2d_model([star, planet], gravity = 3.0, dt=0.1)</code></pre><h2 id="Step-2:-Initialise-the-model."><a class="docs-heading-anchor" href="#Step-2:-Initialise-the-model.">Step 2: Initialise the model.</a><a id="Step-2:-Initialise-the-model.-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-Initialise-the-model." title="Permalink"></a></h2><p>In this step we define an initialiser function to set the initial properties of the agents. Suppose we want our planet to be at position Vect(5.0,8.0) and velocity Vect(-1.0, 0.0) initially. We can do so by defining an initialiser function and then sending it as an argument to <code>init_model!</code> function as follows.</p><pre><code class="language-julia hljs">function initialiser!(model)
    planet = model.agents[2]
    planet.pos = Vect(5.0, 8.0)
    planet.vel = Vect(-1.0,0.0)
end

init_model!(model, initialiser = initialiser!)</code></pre><h2 id="Step-3:-Define-a-step_rule-and-run-the-model"><a class="docs-heading-anchor" href="#Step-3:-Define-a-step_rule-and-run-the-model">Step 3: Define a <code>step_rule</code> and run the model</a><a id="Step-3:-Define-a-step_rule-and-run-the-model-1"></a><a class="docs-heading-anchor-permalink" href="#Step-3:-Define-a-step_rule-and-run-the-model" title="Permalink"></a></h2><p>In this step, we define rule for the time evolution and then run the model. We define our <code>step_rule</code> to be simply discretisation of Newton&#39;s equations for a 2 body system.</p><pre><code class="language-julia hljs">function step_rule!(model)
    gravity = model.properties.gravity
    dt = model.properties.dt
    star = model.agents[1]
    planet = model.agents[2]
    distance_vector = (star.pos - planet.pos)
    distance = veclength(distance_vector)
    force = gravity*distance_vector/distance^3
    planet.vel += force*dt
    planet.pos+= planet.vel*dt
end</code></pre><p>Now we can run the model for desired number of steps as follows</p><pre><code class="language-julia hljs">run_model!(model, steps = 200, step_rule = step_rule!)</code></pre><h2 id="Step-4:-Visualisation"><a class="docs-heading-anchor" href="#Step-4:-Visualisation">Step 4: Visualisation</a><a id="Step-4:-Visualisation-1"></a><a class="docs-heading-anchor-permalink" href="#Step-4:-Visualisation" title="Permalink"></a></h2><p>In order to draw the model at a specific frame, say 4th, one can use <code>draw_frame(model, frame = 4)</code>. We can look at the animation of the time evolution with following line of code</p><pre><code class="language-julia hljs">animate_sim(model,tail = (30, agent -&gt; agent.color == cl&quot;blue&quot;)) </code></pre><p>The tail argument attaches a tail of length 30 to the agent whose color is blue, which in our case is the planet. </p><p><img src="../assets/StarPlanetSystem/StarPlanetAnim1.png" alt="png"/></p><p>The model can be saved to the disk as a jld2 file using following function.</p><pre><code class="language-julia hljs">save_model(model, model_name = &quot;sun_planet_model&quot;, save_as = &quot;sun_planet.jld2&quot;, folder = &quot;/path/to/folder/&quot;)</code></pre><p>A model saved previously as jld2 file, can be fetched as follows </p><pre><code class="language-julia hljs">model = open_model(model_name = &quot;sun_planet_model&quot;, path = &quot;/path/to/folder/sun_planet.jld2&quot;)</code></pre><p>Instead of first running the model, we can create an interactive app in Jupyter notebook to explore the model by setting different values of properties, as shown below. It is recommended to define a fresh model and not initialise it with <code>init_model!</code> or run with <code>run_model!</code> before creating interactive app. The <code>model_control</code> argument asks EasyABM to create a slider with values from 1 to 5 in steps of 0.2 for the model parameter <code>gravity</code>. The agent_controls argument creates a slider for the x component of planet&#39;s initial velocity. The tail argument attaches a tail of length 30 with the planet by selecting it with its color property which we previously set to <code>cl&quot;blue&quot;</code>. </p><pre><code class="language-julia hljs">star = con_2d_agent( pos = Vect(5.0,5.0), size = 0.15, color = cl&quot;yellow&quot;) 

planet = con_2d_agent(pos = Vect(7.0,5.0), vel = Vect(0.0,1.0), size=0.05, color = cl&quot;blue&quot;, keeps_record_of = Set([:pos, :vel])) 

model = create_2d_model([star, planet], gravity = 3.0, dt=0.1)

create_interactive_app(model, initialiser= initialiser!,
    step_rule= step_rule!,
    model_controls=[(:gravity, &quot;slider&quot;, 1:0.2:5.0)], 
    agent_controls=[(:vel, &quot;slider&quot;, [Vect(x, 0.0) for x in -10.0:0.1:5.0])],
    frames=200, tail = (30, agent -&gt; agent.color == cl&quot;blue&quot;)) </code></pre><p><img src="../assets/StarPlanetSystem/StarPlanetIntApp.png" alt="png"/></p><h2 id="Step-5:-Fetch-data"><a class="docs-heading-anchor" href="#Step-5:-Fetch-data">Step 5: Fetch data</a><a id="Step-5:-Fetch-data-1"></a><a class="docs-heading-anchor-permalink" href="#Step-5:-Fetch-data" title="Permalink"></a></h2><p>In this simple model, the only data we have collected is the position and velocity of the planet. We can get this data as follows. </p><pre><code class="language-julia hljs">df = get_agent_data(model.agents[2], model).record</code></pre><p>The following line of code returns the data of (half of the) speed of the planet during time evolution.</p><pre><code class="language-julia hljs">df = get_agents_avg_props(model, agent -&gt; agent.color == cl&quot;blue&quot; ? veclength(agent.vel) : 0.0, labels = [&quot;Planet Speed/2&quot;], plot_result = true)   </code></pre><p><img src="../assets/StarPlanetSystem/SPSPlot1.png" alt="png"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../cheatsheet/">Working with different types of models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 22 December 2023 05:50">Friday 22 December 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
